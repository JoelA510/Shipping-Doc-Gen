
> @formwaypoint/api@0.1.0 test
> jest

FAIL src/services/compliance/complianceService.test.js
  ΓùÅ Test suite failed to run

    Cannot find module './complianceService' from 'src/services/compliance/complianceService.test.js'

    However, Jest was able to find:
    	'./complianceService.test.js'

    You might want to include a file extension in your import, or update your 'moduleFileExtensions', which is currently ['js', 'mjs', 'cjs', 'jsx', 'ts', 'tsx', 'json', 'node'].

    See https://jestjs.io/docs/configuration#modulefileextensions-arraystring

    > 1 | const complianceService = require('./complianceService');
        |                           ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 |
      4 | jest.mock('@prisma/client', () => {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (src/services/compliance/complianceService.test.js:1:27)

PASS tests/view_models.test.js
PASS tests/csv_unit.test.js
PASS tests/validation.test.js
FAIL tests/party_service.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/parties/partyService' from 'tests/party_service.test.js'

    > 1 | const partyService = require('../src/services/parties/partyService');
        |                      ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 | const prisma = new PrismaClient();
      4 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/party_service.test.js:1:22)

PASS tests/auth_middleware.test.js
PASS tests/ocr.test.js
FAIL tests/item_service.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/items/itemService' from 'tests/item_service.test.js'

    > 1 | const itemService = require('../src/services/items/itemService');
        |                     ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 | const prisma = new PrismaClient();
      4 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/item_service.test.js:1:21)

FAIL tests/socket_integration.test.js
  ΓùÅ Test suite failed to run

    Cannot find module 'socket.io-client' from 'tests/socket_integration.test.js'

      1 | const { createServer } = require('http');
      2 | const { Server } = require('socket.io');
    > 3 | const Client = require('socket.io-client');
        |                ^
      4 | const jwt = require('jsonwebtoken');
      5 | const config = require('../src/config');
      6 | const { initSocket } = require('../src/services/socket');

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/socket_integration.test.js:3:16)

FAIL tests/carriers.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/carriers/carrierGateway' from 'tests/carriers.test.js'

      59 | // 4. Mock Carrier Gateway to spy on getRates
      60 | const mockGetRates = jest.fn();
    > 61 | jest.mock('../src/services/carriers/carrierGateway', () => ({
         |      ^
      62 |     getCarrierGateway: jest.fn().mockImplementation(() => ({
      63 |         getRates: mockGetRates,
      64 |         bookShipment: jest.fn()

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (tests/carriers.test.js:61:6)

PASS tests/auth.test.js
FAIL tests/caching.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/carriers/carrierGateway' from 'tests/caching.test.js'

      15 | }));
      16 |
    > 17 | jest.mock('../src/services/carriers/carrierGateway', () => ({
         |      ^
      18 |     getCarrierGateway: jest.fn()
      19 | }));
      20 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (tests/caching.test.js:17:6)

PASS tests/files_security.test.js
  ΓùÅ Console

    console.warn
      [Security] Unauthorized file access attempt by user intruder-999 for test-file.pdf

      52 |         if (!isAuthorized) {
      53 |             // Log attempt
    > 54 |             console.warn(`[Security] Unauthorized file access attempt by user ${userId} for ${filename}`);
         |                     ^
      55 |             // Return 404 to prevent enumeration, or 403 if we want to be explicit. 
      56 |             // 404 is safer for static assets.
      57 |             return res.status(404).json({ error: 'File not found or access denied' });

      at warn (src/routes/files.js:54:21)

PASS tests/queue.test.js
FAIL tests/parties_shipments.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/parties_shipments.test.js:93:13)

FAIL tests/tenancy.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/tenancy.test.js:82:13)

FAIL tests/history_comments.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/history_comments.test.js:25:13)

FAIL tests/lifecycle.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/lifecycle.test.js:50:13)

FAIL tests/integration.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/integration.test.js:93:13)

FAIL tests/upload_security.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/upload_security.test.js:41:13)

FAIL tests/sanity.test.js (5.578 s)
  ΓùÅ Sanity Check ΓÇ║ should import app without crashing

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/sanity.test.js:33:21)

FAIL tests/portability.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/portability.test.js:70:13)

PASS tests/generator.test.js (5.677 s)
  ΓùÅ Console

    console.log
      2026-01-16T19:04:54.348Z info: Loading template  {"service":"shipping-doc-gen-api","templateName":"sli","templatePath":"C:\\Users\\joel.abraham\\FormWaypoint\\FormWaypoint\\apps\\api\\src\\templates\\sli.hbs"}

      at Console.log (../../node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [Browser] Launching new browser instance...

      at log (src/services/browser.js:7:17)

    console.log
      [Generator] PDF generated successfully for template: sli

      at log (src/services/generator.js:59:17)

FAIL tests/features.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/features.test.js:75:13)

FAIL tests/csv_import.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/csv_import.test.js:49:13)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Summary of all failing tests
FAIL src/services/compliance/complianceService.test.js
  ΓùÅ Test suite failed to run

    Cannot find module './complianceService' from 'src/services/compliance/complianceService.test.js'

    However, Jest was able to find:
    	'./complianceService.test.js'

    You might want to include a file extension in your import, or update your 'moduleFileExtensions', which is currently ['js', 'mjs', 'cjs', 'jsx', 'ts', 'tsx', 'json', 'node'].

    See https://jestjs.io/docs/configuration#modulefileextensions-arraystring

    > 1 | const complianceService = require('./complianceService');
        |                           ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 |
      4 | jest.mock('@prisma/client', () => {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (src/services/compliance/complianceService.test.js:1:27)

FAIL tests/party_service.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/parties/partyService' from 'tests/party_service.test.js'

    > 1 | const partyService = require('../src/services/parties/partyService');
        |                      ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 | const prisma = new PrismaClient();
      4 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/party_service.test.js:1:22)

FAIL tests/item_service.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/items/itemService' from 'tests/item_service.test.js'

    > 1 | const itemService = require('../src/services/items/itemService');
        |                     ^
      2 | const { PrismaClient } = require('@prisma/client');
      3 | const prisma = new PrismaClient();
      4 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/item_service.test.js:1:21)

FAIL tests/socket_integration.test.js
  ΓùÅ Test suite failed to run

    Cannot find module 'socket.io-client' from 'tests/socket_integration.test.js'

      1 | const { createServer } = require('http');
      2 | const { Server } = require('socket.io');
    > 3 | const Client = require('socket.io-client');
        |                ^
      4 | const jwt = require('jsonwebtoken');
      5 | const config = require('../src/config');
      6 | const { initSocket } = require('../src/services/socket');

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.require (tests/socket_integration.test.js:3:16)

FAIL tests/carriers.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/carriers/carrierGateway' from 'tests/carriers.test.js'

      59 | // 4. Mock Carrier Gateway to spy on getRates
      60 | const mockGetRates = jest.fn();
    > 61 | jest.mock('../src/services/carriers/carrierGateway', () => ({
         |      ^
      62 |     getCarrierGateway: jest.fn().mockImplementation(() => ({
      63 |         getRates: mockGetRates,
      64 |         bookShipment: jest.fn()

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (tests/carriers.test.js:61:6)

FAIL tests/caching.test.js
  ΓùÅ Test suite failed to run

    Cannot find module '../src/services/carriers/carrierGateway' from 'tests/caching.test.js'

      15 | }));
      16 |
    > 17 | jest.mock('../src/services/carriers/carrierGateway', () => ({
         |      ^
      18 |     getCarrierGateway: jest.fn()
      19 | }));
      20 |

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (tests/caching.test.js:17:6)

FAIL tests/parties_shipments.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/parties_shipments.test.js:93:13)

FAIL tests/tenancy.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/tenancy.test.js:82:13)

FAIL tests/history_comments.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/history_comments.test.js:25:13)

FAIL tests/lifecycle.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/lifecycle.test.js:50:13)

FAIL tests/integration.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/integration.test.js:93:13)

FAIL tests/upload_security.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/upload_security.test.js:41:13)

FAIL tests/sanity.test.js (5.578 s)
  ΓùÅ Sanity Check ΓÇ║ should import app without crashing

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/sanity.test.js:33:21)

FAIL tests/portability.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/portability.test.js:70:13)

FAIL tests/features.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/features.test.js:75:13)

FAIL tests/csv_import.test.js
  ΓùÅ Test suite failed to run

    TypeError: nodemailer.createTransport is not a function

      4 |
      5 | // Email configuration
    > 6 | const transporter = nodemailer.createTransport({
        |                                ^
      7 |     host: config.email.host,
      8 |     port: config.email.port,
      9 |     secure: config.email.port === 465, // True for 465, false for 587

      at Object.createTransport (src/services/email.js:6:32)
      at Object.require (src/routes/notifications.js:4:23)
      at Object.require (src/index.js:15:29)
      at Object.require (tests/csv_import.test.js:49:13)


Test Suites: 16 failed, 9 passed, 25 total
Tests:       1 failed, 37 passed, 38 total
Snapshots:   0 total
Time:        7.239 s
Ran all test suites.
npm error Lifecycle script `test` failed with error:
npm error code 1
npm error path C:\Users\joel.abraham\FormWaypoint\FormWaypoint\apps\api
npm error workspace @formwaypoint/api@0.1.0
npm error location C:\Users\joel.abraham\FormWaypoint\FormWaypoint\apps\api
npm error command failed
npm error command C:\Windows\system32\cmd.exe /d /s /c jest
